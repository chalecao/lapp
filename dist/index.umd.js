!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(e.lapp={})}(this,function(e){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)},i=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n},u=function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)},a=function(e){return function(t){return(void 0===t?"undefined":n(t))===e}},c=function(e){return function(n){return n.type===e}},f=function(e){return a("undefined")(e)&&void 0==e},d=a("string"),l=a("boolean"),s=a("number"),p=function(e){return e.toString().match("function")},h=function(e){return e.toString().match("class ")},v=function(e){return null===e},y=c("native"),b=c("thunk"),m=c("text"),g=Array.isArray,O=function(e){return"Object"==Object.prototype.toString.call(e).slice(8,-1)},k=function(e,n){return e.fn===n.fn},_=function(e){return["svg","path","animate"].indexOf(e)>=0},j=function(e){return/^on/.test(e)},E=function(e){return e.slice(2).toLowerCase()},A=function(e,n){var t=-1,r=e.find(function(e,r){if(e.fn&&e.fn.toString().match(n))return t=r,!0});return{index:t,children:r}},w=function e(n){var t;if(O(n))t={};else{if(!g(n))return n;t=[]}for(var r in n){var o=n[r];O(o)?t[r]=e(o):g(o)?t[r]=e(o):t[r]=n[r]}return t};function N(e){for(var n=arguments,t=arguments.length,r=Array(t>2?t-2:0),o=2;o<t;o++)r[o-2]=n[o];var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e)return r=Array.prototype.reduce.call(r,x,[]),p(e)?function(e,n,t,r){return{type:"thunk",fn:e,props:n,children:t,options:r}}(e,i,r,e):{type:"native",tagName:e,attributes:i,children:r}}function x(e,n){var t;return d(n)||s(n)?e.push({type:(t=n)?"text":"empty",nodeValue:t}):v(n)||f(n)||(g(n)?e=[].concat(u(e),u(n.reduce(x,[]))):e.push(n)),e}var $=function(){function e(){t(this,e)}return r(e,[{key:"$update",value:function(e){e&&e()}},{key:"render",value:function(){}}]),e}();function S(e,n){n&&Object.keys(n).forEach(function(t){j(t)&&e.addEventListener(E(t),n[t])})}function C(e,n,t,r){j(n)||("className"===n?e[r]("class",t):l(t)?function(e,n,t,r){t?(e[r](n,t),e[n]=!0):(e[r](n),e[n]=!1)}(e,n,t,r):void 0!=t&&(""+t).length?e[r](n,t):e.removeAttribute(n))}function P(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},t,n);Object.keys(r).forEach(function(r){j(r)?(!function(e,n){n&&Object.keys(n).forEach(function(t){j(t)&&e.removeEventListener(E(t),n[t])})}(e,{name:t[r]}),S(e,{name:n[r]})):function(e,n,t,r){t?r&&t===r||C(e,n,t,"setAttribute"):C(e,n,l(t)?t:r,"removeAttribute")}(e,r,n[r],t[r])})}function V(e,n){var t=e.props,r={children:e.children,props:t},o=void 0,i=void 0;if(h(e.fn))o=(i=new e.fn).render(r),i.$update=i.$update.bind(this,function(){n&&n("updateAll")});else try{o=e.fn(r)}catch(t){o=(i=new e.fn).render(r),i.$update=i.$update.bind(this,function(){n&&n("updateAll")})}if(!o)return"";var u=T(o);return S(u,o.attributes),o.attributes.onShow&&o.attributes.onShow(),e.state={vnode:o,$ins:i,model:r},u}function L(e,n){var t,r=_(e.tagName)?(t=e.tagName,document.createElementNS("http://www.w3.org/2000/svg",t)):document.createElement(e.tagName);return e.attributes&&P(r,e.attributes),e.attributes&&S(r,e.attributes),e.children.map(function(t){return"thunk"==t.type&&(t.fn.$update=function(){return e.fn.$update&&e.fn.$update()}),T(t,n)}).forEach(r.appendChild.bind(r)),r}var T=function(e,n){var t,r;if(!v(e)&&!f(e))switch(e.type){case"text":return t=e.nodeValue,r=d(t)||s(t)?t:"",document.createTextNode(r);case"thunk":return V(e,n);case"empty":return document.createElement("noscript");case"native":return L(e,n)}};function R(e,n,t){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e&&(n!==t||"thunk"==n.type))if(f(n)||!f(t))if(!f(n)||f(t))if(!v(n)&&v(t)||v(n)&&!v(t))F(e,n,t,r);else if(n.type===t.type)if(t.attributes&&t.attributes.forceUpdate)F(e,n,t,r);else{if(y(t))return n.tagName!==t.tagName?void F(e,n,t,r):(P(e.childNodes[r],t.attributes,n.attributes),void function(e,n,t,r){var o=n.children||[],i=t.children||[],u=void 0,a=Array.prototype.slice.call(e.childNodes),c=i.length;for(u=0;u<o.length||u<c;u++)R(a[r],o[u],i[u],u>=c?c:u)}(e,n,t,r));if(m(t))n.nodeValue!==t.nodeValue&&(e.childNodes[r].nodeValue=t.nodeValue);else if(b(t)){if(!k(n,t))return void function(){q.apply(null,arguments)}(e,n,t,r);if(!n.props.key||n.props.key!=t.props.key)return void q(e,n,t,r)}}else F(e,n,t,r);else e.appendChild(T(t));else!function(e,n,t,r){M(n),e.removeChild(e.childNodes[r])}(e,n,0,r)}function F(e,n,t,r){var o=T(t);return M(n),e.replaceChild(o,e.childNodes[r]),o}function M(e){for(;b(e);){var n=e.options.onRemove,t=e.state.model;n&&n(t),e=e.state.vnode}e.children&&e.children.forEach(M)}function q(e,n,t,r){var o=t.props,i={children:t.children,props:o},u=void 0;if(h(t.fn))u=n.state.$ins.render(i);else try{u=t.fn(i)}catch(e){u=n.state.$ins.render(i)}return R(e,n.state.vnode,u,r),t.state={vnode:u,$ins:n.state.$ins,model:i},e}function H(e,n){var t=this,r=n||{node:null,oldNode:null,ins:null},o=r.node,i=r.oldNode,u=r.ins;e="string"==typeof e?document.querySelector(e):e;var a=function(n){return"updateAll"===n&&function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{n=u&&u.render()}catch(e){}R(t,i,n),i=n}()};return n||(e.innerHTML=""),function(n){var r=n;if(r.children&&!r.children.length){var c=r,f=c.props,d=c.children,l=c.fn,s={children:d,props:f};(r=r.fn(s)).fn=l}return"render"in n&&(r=n.render(),u=n,n.$update=n.$update.bind(t,function(){a("updateAll")})),o?function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return R(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i,n),{node:o,oldNode:i=n,ins:u}}(r):function(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return o=T(n,a),t.appendChild(o),{node:o,oldNode:i=n,ins:u}}(r)}}var I=N,U=$,z=function(e){function n(){return t(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return o(n,$),r(n,[{key:"render",value:function(e){var n=e.props,t=e.children,r=w(t),o=A(t,"else");o.index>=0&&r.splice(o.index,1);var i=w(n);return delete i.cond,n.cond?N("div",i,r):N("div",i,o.children)}}]),n}(),B=function(e){function u(){return t(this,u),i(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return o(u,$),r(u,[{key:"handlePath",value:function(e,n){var t=e.match(/__(.*?)__/g),r="";return t&&t.forEach(function(t){r=n[t.substring(2,t.length-2)],e=e.replace(t,void 0===r?"":r)}),e}},{key:"handleAttribute",value:function(e,n){var t=this;Object.keys(e).forEach(function(r){e[r]=t.handlePath(e[r],n)})}},{key:"handleChildren",value:function(e,n){var t=this;return e.forEach(function(e){e.nodeValue&&(e.nodeValue=t.handlePath(e.nodeValue,n)),e.attributes&&t.handleAttribute(e.attributes,n),e.children&&t.handleChildren(e.children,n)}),e}},{key:"render",value:function(e){var t=this,r=e.props,o=e.children;if(r.data){var i="",u=[];r.data.forEach(function(e,a){e.index=a,i=function e(t,r){var o={};return Object.keys(t).forEach(function(i){o[r+"."+i]=t[i],"object"===n(t[i])&&(o=Object.assign(o,e(t[i],r+"."+i)))}),o}(e,r.key||"item"),u=u.concat(t.handleChildren(w(o),i))});var a=w(r);return delete a.data,delete a.key,N("div",a,u)}return""}}]),u}(),D=function(e){function n(){return t(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return o(n,$),r(n,[{key:"render",value:function(e){var n=e.props,t=e.children;if(n&&Object.keys(n).indexOf("cond")>=0){var r=A(t,"else"),o=t;r.index>=0&&(o=w(t)).splice(r.index,1);var i=w(n);return delete i.cond,n.cond?N("div",i,o):N("div",i,r.children)}return N("div",n,t)}}]),n}();e.l=I,e.component=U,e.IF=z,e.FOR=B,e.ELSE=D,e.app=function(e){for(var n=arguments,t=arguments.length,r=Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=n[o];return function(){if("render"in r[0])H(e)(r[0]);else{var n=H(e)(N(r[0],null));r.map(function(t){t.$update=function(){n=H(e,n)(N(r[0],null))}})}}()},Object.defineProperty(e,"__esModule",{value:!0})});
