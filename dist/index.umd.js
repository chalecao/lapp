!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.lapp={})}(this,function(e){"use strict";var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},u=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)},a=function(e){return function(n){return(void 0===n?"undefined":t(n))===e}},c=function(e){return function(t){return t.type===e}},f=function(e){return a("undefined")(e)&&void 0==e},d=a("string"),l=a("boolean"),s=a("number"),p=function(e){return e.toString().match("function")},h=function(e){return e.toString().match("class ")},v=function(e){return null===e},y=c("native"),b=c("thunk"),m=c("text"),g=Array.isArray,O=function(e){return"Object"==Object.prototype.toString.call(e).slice(8,-1)},k=function(e,t){return e.fn===t.fn},_=function(e){return["svg","path","animate"].indexOf(e)>=0},j=function(e){return/^on/.test(e)},E=function(e){return e.slice(2).toLowerCase()},A=function(e,t){var n=-1,r=e.find(function(e,r){if(e.fn&&e.fn.toString().match(t))return n=r,!0});return{index:n,children:r}},N=function e(t){var n;if(O(t))n={};else{if(!g(t))return t;n=[]}for(var r in t){var o=t[r];O(o)?n[r]=e(o):g(o)?n[r]=e(o):n[r]=t[r]}return n};function w(e){for(var t=arguments,n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=t[o];var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e)return r=Array.prototype.reduce.call(r,x,[]),p(e)?function(e,t,n,r){return{type:"thunk",fn:e,props:t,children:n,options:r}}(e,i,r,e):{type:"native",tagName:e,attributes:i,children:r}}function x(e,t){var n;return d(t)||s(t)?e.push({type:(n=t)?"text":"empty",nodeValue:n}):v(t)||f(t)||(g(t)?e=[].concat(u(e),u(t.reduce(x,[]))):e.push(t)),e}var $=function(){function e(){n(this,e)}return r(e,[{key:"$update",value:function(e){e&&e()}},{key:"render",value:function(){}}]),e}();function S(e,t){t&&Object.keys(t).forEach(function(n){j(n)&&e.addEventListener(E(n),t[n])})}function C(e,t,n,r){j(t)||("className"===t?e[r]("class",n):l(n)?function(e,t,n,r){n?(e[r](t,n),e[t]=!0):(e[r](t),e[t]=!1)}(e,t,n,r):void 0!=n&&(""+n).length?e[r](t,n):e.removeAttribute(t))}function M(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n,t);Object.keys(r).forEach(function(r){j(r)?(!function(e,t){t&&Object.keys(t).forEach(function(n){j(n)&&e.removeEventListener(E(n),t[n])})}(e,{name:n[r]}),S(e,{name:t[r]})):function(e,t,n,r){n?r&&n===r||C(e,t,n,"setAttribute"):C(e,t,l(n)?n:r,"removeAttribute")}(e,r,t[r],n[r])})}function P(e,t){var n=e.props,r={children:e.children,props:n},o=void 0,i=void 0;if(h(e.fn))o=(i=new e.fn).render(r),i.$update=i.$update.bind(this,function(){t&&t("updateAll")});else try{o=e.fn(r)}catch(n){o=(i=new e.fn).render(r),i.$update=i.$update.bind(this,function(){t&&t("updateAll")})}if(!o)return"";var u=L(o);return S(u,o.attributes),e.onMount=o.attributes.onMount,e.afterMount=o.attributes.afterMount,e.state={vnode:o,$ins:i,model:r},u}function V(e,t){var n,r=_(e.tagName)?(n=e.tagName,document.createElementNS("http://www.w3.org/2000/svg",n)):document.createElement(e.tagName);return e.attributes&&M(r,e.attributes),e.attributes&&S(r,e.attributes),e.children.map(function(e){return{item:e,el:L(e,t)}}).forEach(function(t){var n=t.item,o=t.el;"thunk"==n.type&&(n.fn.$update=function(){return e.fn.$update&&e.fn.$update()}),n.onMount&&n.onMount(),r.appendChild(o),n.afterMount&&n.afterMount()}),r}var L=function(e,t){var n,r;if(!v(e)&&!f(e))switch(e.type){case"text":return n=e.nodeValue,r=d(n)||s(n)?n:"",document.createTextNode(r);case"thunk":return P(e,t);case"empty":return document.createElement("noscript");case"native":return V(e,t)}};function T(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e)return t===n&&"thunk"!=t.type?e:!f(t)&&f(n)?function(e,t,n,r){U(t),e.removeChild(e.childNodes[r])}(e,t,0,r):f(t)&&!f(n)?(e.appendChild(L(n)),e):!v(t)&&v(n)||v(t)&&!v(n)?R(e,t,n,r):t.type!==n.type?R(e,t,n,r):n.attributes&&n.attributes.forceUpdate?R(e,t,n,r):y(n)?t.tagName!==n.tagName?R(e,t,n,r):(M(e.childNodes[r],n.attributes,t.attributes),function(e,t,n,r){var o=t.children||[],i=n.children||[],u=void 0,a=Array.prototype.slice.call(e.childNodes),c=i.length;for(u=0;u<o.length||u<c;u++)T(a[r],o[u],i[u],u>=c?c:u);return e}(e,t,n,r)):m(n)?(t.nodeValue!==n.nodeValue&&(e.childNodes[r].nodeValue=n.nodeValue),e):b(n)?k(t,n)?F(e,t,n,r):function(){return F.apply(null,arguments)}(e,t,n,r):void 0}function R(e,t,n,r){var o=L(n);return U(t),e.replaceChild(o,e.childNodes[r]),o}function U(e){for(;b(e);){var t=e.options.onRemove,n=e.state.model;t&&t(n),e=e.state.vnode}e.children&&e.children.forEach(U)}function F(e,t,n,r){var o=n.props,i={children:n.children,props:o},u=void 0;if(h(n.fn))u=t.state.$ins.render(i);else try{u=n.fn(i)}catch(e){u=t.state.$ins.render(i)}return o.onUpdate&&o.onUpdate(),T(e,t.state.vnode,u,r),n.state={vnode:u,$ins:t.state.$ins,model:i},e}function q(e,t){var n=this,r=t||{node:null,oldNode:null,ins:null},o=r.node,i=r.oldNode,u=r.ins;e="string"==typeof e?document.querySelector(e):e;var a=function(t){return"updateAll"===t&&function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{t=u&&u.render()}catch(e){}T(n,i,t),i=t}()};return t||(e.innerHTML=""),function(t){var r=t;if(r.children&&!r.children.length){var c=r,f=c.props,d=c.children,l=c.fn,s={children:d,props:f};(r=r.fn(s)).fn=l}return"render"in t&&(r=t.render(),u=t,t.$update=t.$update.bind(n,function(){a("updateAll")})),o?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return T(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i,t),{node:o,oldNode:i=t,ins:u}}(r):function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return o=L(t,a),n.appendChild(o),{node:o,oldNode:i=t,ins:u}}(r)}}var H=w,I=$,z=function(e){function t(){return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,$),r(t,[{key:"render",value:function(e){var t=e.props,n=e.children,r=N(n),o=A(n,"else");o.index>=0&&r.splice(o.index,1);var i=N(t);return delete i.cond,t.cond?w("div",i,r):w("div",i,o.children)}}]),t}(),B=function(e){function u(){return n(this,u),i(this,(u.__proto__||Object.getPrototypeOf(u)).apply(this,arguments))}return o(u,$),r(u,[{key:"handlePath",value:function(e,t){var n=e.match(/__(.*?)__/g),r="";return n&&n.forEach(function(n){r=t[n.substring(2,n.length-2)],e=e.replace(n,void 0===r?"":r)}),e}},{key:"handleAttribute",value:function(e,t){var n=this;Object.keys(e).forEach(function(r){e[r]=n.handlePath(e[r],t)})}},{key:"handleChildren",value:function(e,t){var n=this;return e.forEach(function(e){e.nodeValue&&(e.nodeValue=n.handlePath(e.nodeValue,t)),e.attributes&&n.handleAttribute(e.attributes,t),e.children&&n.handleChildren(e.children,t)}),e}},{key:"render",value:function(e){var n=this,r=e.props,o=e.children;if(r.data){var i="",u=[];r.data.forEach(function(e,a){e.index=a,i=function e(n,r){var o={};return Object.keys(n).forEach(function(i){o[r+"."+i]=n[i],"object"===t(n[i])&&(o=Object.assign(o,e(n[i],r+"."+i)))}),o}(e,r.key||"item"),u=u.concat(n.handleChildren(N(o),i))});var a=N(r);return delete a.data,delete a.key,w("div",a,u)}return""}}]),u}(),D=function(e){function t(){return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,$),r(t,[{key:"render",value:function(e){var t=e.props,n=e.children;if(t&&Object.keys(t).indexOf("cond")>=0){var r=A(n,"else"),o=n;r.index>=0&&(o=N(n)).splice(r.index,1);var i=N(t);return delete i.cond,t.cond?w("div",i,o):w("div",i,r.children)}return w("div",t,n)}}]),t}();e.l=H,e.component=I,e.IF=z,e.FOR=B,e.ELSE=D,e.app=function(e){for(var t=arguments,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=t[o];return function(){if("render"in r[0])q(e)(r[0]);else{var t=q(e)(w(r[0],null));r.map(function(n){n.$update=function(){t=q(e,t)(w(r[0],null))}})}}()},Object.defineProperty(e,"__esModule",{value:!0})});
