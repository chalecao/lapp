var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},isType=function(e){return function(t){return(void 0===t?"undefined":_typeof(t))===e}},isVType=function(e){return function(t){return t.type===e}},isUndefined=function(e){return isType("undefined")(e)&&void 0==e},isString=isType("string"),isBool=isType("boolean"),isNumber=isType("number"),isFunction=function(e){return e.toString().match("function")},isClass=function(e){return e.toString().match("class ")},isNull=function(e){return null===e},isNative=isVType("native"),isThunk=isVType("thunk"),isText=isVType("text"),isArray=Array.isArray,isObj=function(e){return"Object"==Object.prototype.toString.call(e).slice(8,-1)},isSameThunk=function(e,t){return e.fn===t.fn},isSVG=function(e){return["svg","path","animate"].indexOf(e)>=0},isEventProp=function(e){return/^on/.test(e)},extractEventName=function(e){return e.slice(2).toLowerCase()},isCustomProp=function(e){return isEventProp(e)||"forceUpdate"===e},JSON2Hash=function e(t,n){var r={};return Object.keys(t).forEach(function(i){r[n+"."+i]=t[i],"object"==_typeof(t[i])&&(r=Object.assign(r,e(t[i],n+"."+i)))}),r},findChildren=function(e,t){var n=-1,r=e.reverse().find(function(e,r){if(e.fn&&e.fn.toString().match(t))return n=r,!0});return{index:n,children:r}},deepClone=function e(t){var n;if(isObj(t))n={};else{if(!isArray(t))return t;n=[]}for(var r in t){var i=t[r];isObj(i)?n[r]=e(i):isArray(i)?n[r]=e(i):n[r]=t[r]}return n},uti=Object.freeze({isUndefined:isUndefined,isString:isString,isBool:isBool,isNumber:isNumber,isFunction:isFunction,isClass:isClass,isNull:isNull,isNative:isNative,isThunk:isThunk,isText:isText,isArray:isArray,isObj:isObj,isSameThunk:isSameThunk,isSVG:isSVG,isEventProp:isEventProp,extractEventName:extractEventName,isCustomProp:isCustomProp,JSON2Hash:JSON2Hash,findChildren:findChildren,deepClone:deepClone});function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function createNode(e,t){for(var n=arguments,r=arguments.length,i=Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=n[o];if(!e)throw new TypeError("element() needs a type.");return t=t||{},i=Array.prototype.reduce.call(i||[],reduceChildren,[]),isFunction(e)?createThunkElement(e,t,i,e):{type:"native",tagName:e,attributes:t,children:i}}function createThunkElement(e,t,n,r){return{type:"thunk",fn:e,props:t,children:n,options:r}}function createTextElement(e){return{type:e?"text":"empty",nodeValue:e}}function reduceChildren(e,t){return isString(t)||isNumber(t)?e.push(createTextElement(t)):isNull(t)||isUndefined(t)?e.push(createTextElement()):Array.isArray(t)?e=[].concat(_toConsumableArray(e),_toConsumableArray(t.reduce(reduceChildren,[]))):e.push(t),e}function operBooleanProp(e,t,n,r){n?(e[r](t,n),e[t]=!0):(e[r](t),e[t]=!1)}function operAttribute(e,t,n,r){isCustomProp(t)||("className"===t?e[r]("class",n):"boolean"==typeof n?operBooleanProp(e,t,n,r):""!==n&&void 0!=n?e[r](t,n):e.removeAttribute(t))}function updateAttribute(e,t,n,r){n?r&&n===r||operAttribute(e,t,n,"setAttribute"):operAttribute(e,t,"boolean"==typeof n?n:r,"removeAttribute")}function updateAttributes(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n,t);Object.keys(r).forEach(function(r){!isEventProp(r)&&updateAttribute(e,r,t[r],n[r])})}function addEventListeners(e,t){t&&Object.keys(t).forEach(function(n){isEventProp(n)&&e.addEventListener(extractEventName(n),t[n])})}function createTextNode(e){var t=isString(e)||isNumber(e)?e:"";return document.createTextNode(t)}function createThunk(e,t){var n=e.props,r=e.children,i=e.options.onCreate,o={children:r,props:n},u=void 0,a=void 0;if(isClass(e.fn))u=(a=new e.fn).render(o),a.$update=a.$update.bind(this,function(){t&&t("updateAll")});else try{u=e.fn(o)}catch(n){u=(a=new e.fn).render(o),a.$update=a.$update.bind(this,function(){t&&t("updateAll")})}if(!u)return"";var s=createElement(u);return addEventListeners(s,u.attributes),i&&i(o),e.state={vnode:u,$ins:a,model:o},s}function createSVGElement(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function createHTMLElement(e,t){var n=isSVG(e.tagName)?createSVGElement(e.tagName):document.createElement(e.tagName);return e.attributes&&updateAttributes(n,e.attributes),e.attributes&&addEventListeners(n,e.attributes),e.children.map(function(e){return createElement(e,t)}).forEach(n.appendChild.bind(n)),n}function createEmptyHTMLElement(){return document.createElement("noscript")}function createElement(e,t){if(!isNull(e)&&!isUndefined(e))switch(e.type){case"text":return createTextNode(e.nodeValue);case"thunk":return createThunk(e,t);case"empty":return createEmptyHTMLElement();case"native":return createHTMLElement(e,t)}}function updateElement(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e)return t===n&&"thunk"!=t.type?e:!isUndefined(t)&&isUndefined(n)?removeNode(e,t,n,r):isUndefined(t)&&!isUndefined(n)?(e.appendChild(createElement(n)),e):!isNull(t)&&isNull(n)||isNull(t)&&!isNull(n)?replaceNode(e,t,n,r):t.type!==n.type?replaceNode(e,t,n,r):isNative(n)?t.tagName!==n.tagName?replaceNode(e,t,n,r):(updateAttributes(e.childNodes[r],n.attributes,t.attributes),diffChildren(e,t,n,r)):isText(n)?(t.nodeValue!==n.nodeValue&&(e.childNodes[r].nodeValue=n.nodeValue),e):isThunk(n)?isSameThunk(t,n)?updateThunk(e,t,n,r):replaceThunk(e,t,n,r):void 0}function updateTarget(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return!isUndefined(t)&&isUndefined(n)?removeNode(e,t,n,r):isUndefined(t)&&!isUndefined(n)?(e.appendChild(createElement(n)),e):!isNull(t)&&isNull(n)||isNull(t)&&!isNull(n)||t.type!==n.type?replaceNode(e,t,n,r):isNative(n)?t.tagName!==n.tagName?replaceNode(e,t,n,r):(updateAttributes(e.childNodes[r],n.attributes,t.attributes),diffChildren(e,t,n,r)):isText(n)?(t.nodeValue!==n.nodeValue&&(e.childNodes[r].nodeValue=n.nodeValue),e):isThunk(n)?isSameThunk(t,n)?updateThunk(e,t,n,r):replaceThunk(e,t,n,r):void 0}function removeNode(e,t,n,r){removeThunk(t),e.removeChild(e.childNodes[r])}function replaceNode(e,t,n,r){var i=createElement(n);return removeThunk(t),e.replaceChild(i,e.childNodes[r]),i}function removeThunk(e){for(;isThunk(e);){var t=e.options.onRemove,n=e.state.model;t&&t(n),e=e.state.vnode}e.children&&e.children.forEach(removeThunk)}function diffChildren(e,t,n,r){var i=t.children||[],o=n.children||[],u=void 0,a=Array.prototype.slice.call(e.childNodes);for(u=0;u<i.length||u<o.length;u++)updateElement(a[r],i[u],o[u],u);return e}function updateThunk(e,t,n,r){var i=n.props,o={children:n.children,props:i},u=void 0;if(isClass(n.fn))u=t.state.$ins.render(o);else try{u=n.fn(o)}catch(e){u=t.state.$ins.render(o)}return updateElement(e,t.state.vnode,u,r),n.state={vnode:u,$ins:t.state.$ins,model:o},e}function replaceThunk(){return updateThunk.apply(null,arguments)}function initNode$1(e,t){var n=this,r=t||{node:null,oldNode:null,ins:null},i=r.node,o=r.oldNode,u=r.ins,a=function(t){return"updateAll"==t&&function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{t=u&&u.render()}catch(e){}updateTarget(n,o,t),o=t}()};return t||(e.innerHTML=""),function(t){var r=t;if(r.children&&!r.children.length){var s=r,d=s.props,l={children:s.children,props:d};r=r.fn(l)}return"render"in t&&(r=t.render(),u=t,t.$update=t.$update.bind(n,function(){a("updateAll")})),i?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return updateElement(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o,t),{node:i,oldNode:o=t,ins:u}}(r):function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return i=createElement(t,a),n.appendChild(i),{node:i,oldNode:o=t,ins:u}}(r)}}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var initNode,component$1=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"$update",value:function(e){e&&e()}},{key:"render",value:function(){}}]),e}(),creatNode=createNode,component=component$1,createDom=createElement,util=uti,app=function(e){for(var t,n=arguments,r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=n[o];return t=initNode(e)(createNode(i[0],null)),void i.map(function(n){n.$update=function(){t=initNode(e,t)(createNode(i[0],null))}})};export{creatNode,initNode$1 as initNode,component,createDom,util,app};
