"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(t){return function(n){return(void 0===n?"undefined":e(n))===t}},n=function(e){return function(t){return t.type===e}},r=function(e){return t("undefined")(e)&&void 0==e},o=t("string"),i=t("boolean"),u=t("number"),a=function(e){return e.toString().match("function")},c=function(e){return e.toString().match("class ")},f=function(e){return null===e},l=n("native"),d=n("thunk"),s=n("text"),p=Array.isArray,h=function(e){return"Object"==Object.prototype.toString.call(e).slice(8,-1)},v=function(e,t){return e.fn===t.fn},y=function(e){return["svg","path","animate"].indexOf(e)>=0},b=function(e){return/^on/.test(e)},m=function(e){return e.slice(2).toLowerCase()},g=function t(n,r){var o={};return Object.keys(n).forEach(function(i){o[r+"."+i]=n[i],"object"===e(n[i])&&(o=Object.assign(o,t(n[i],r+"."+i)))}),o},O=function(e,t){var n=-1,r=e.find(function(e,r){if(e.fn&&e.fn.toString().match(t))return n=r,!0});return{index:n,children:r}},w=function e(t){var n;if(h(t))n={};else{if(!p(t))return t;n=[]}for(var r in t){var o=t[r];h(o)?n[r]=e(o):p(o)?n[r]=e(o):n[r]=t[r]}return n};function j(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function _(e){for(var t=arguments,n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=t[o];var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e)return r=Array.prototype.reduce.call(r,x,[]),a(e)?E(e,i,r,e):{type:"native",tagName:e,attributes:i,children:r}}function E(e,t,n,r){return{type:"thunk",fn:e,props:t,children:n,options:r}}function k(e){return{type:e?"text":"empty",nodeValue:e}}function x(e,t){return o(t)||u(t)?e.push(k(t)):f(t)||r(t)||(p(t)?e=[].concat(j(e),j(t.reduce(x,[]))):e.push(t)),e}var A=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function N(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var P=function(){function e(){N(this,e)}return A(e,[{key:"$update",value:function(e){e&&e()}},{key:"render",value:function(){}}]),e}();function S(e,t){t&&Object.keys(t).forEach(function(n){b(n)&&e.addEventListener(m(n),t[n])})}function C(e,t){t&&Object.keys(t).forEach(function(n){b(n)&&e.removeEventListener(m(n),t[n])})}function $(e,t,n,r){n?(e[r](t,n),e[t]=!0):(e[r](t),e[t]=!1)}function T(e,t,n,r){b(t)||("className"===t?e[r]("class",n):i(n)?$(e,t,n,r):void 0!=n&&(""+n).length?e[r](t,n):e.removeAttribute(t))}function V(e,t,n,r){n?r&&n===r||T(e,t,n,"setAttribute"):T(e,t,i(n)?n:r,"removeAttribute")}function L(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Object.assign({},n,t);Object.keys(r).forEach(function(r){b(r)?(C(e,{name:n[r]}),S(e,{name:t[r]})):V(e,r,t[r],n[r])})}function R(e){var t=o(e)||u(e)?e:"";return document.createTextNode(t)}function F(e,t){var n=e.props,r=e.children,o=e.options.onCreate,i={children:r,props:n},u=void 0,a=void 0;if(c(e.fn))u=(a=new e.fn).render(i),a.$update=a.$update.bind(this,function(){t&&t("updateAll")});else try{u=e.fn(i)}catch(n){u=(a=new e.fn).render(i),a.$update=a.$update.bind(this,function(){t&&t("updateAll")})}if(!u)return"";var f=I(u);return S(f,u.attributes),o&&o(i),e.state={vnode:u,$ins:a,model:i},f}function M(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function q(e,t){var n=y(e.tagName)?M(e.tagName):document.createElement(e.tagName);return e.attributes&&L(n,e.attributes),e.attributes&&S(n,e.attributes),e.children.map(function(e){return I(e,t)}).forEach(n.appendChild.bind(n)),n}function H(){return document.createElement("noscript")}var I=function(e,t){if(!f(e)&&!r(e))switch(e.type){case"text":return R(e.nodeValue);case"thunk":return F(e,t);case"empty":return H();case"native":return q(e,t)}};function U(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(e)return t===n&&"thunk"!=t.type?e:!r(t)&&r(n)?z(e,t,n,o):r(t)&&!r(n)?(e.appendChild(I(n)),e):!f(t)&&f(n)||f(t)&&!f(n)?B(e,t,n,o):t.type!==n.type?B(e,t,n,o):n.attributes&&n.attributes.forceUpdate?B(e,t,n,o):l(n)?t.tagName!==n.tagName?B(e,t,n,o):(L(e.childNodes[o],n.attributes,t.attributes),G(e,t,n,o)):s(n)?(t.nodeValue!==n.nodeValue&&(e.childNodes[o].nodeValue=n.nodeValue),e):d(n)?v(t,n)?J(e,t,n,o):K(e,t,n,o):void 0}function z(e,t,n,r){D(t),e.removeChild(e.childNodes[r])}function B(e,t,n,r){var o=I(n);return D(t),e.replaceChild(o,e.childNodes[r]),o}function D(e){for(;d(e);){var t=e.options.onRemove,n=e.state.model;t&&t(n),e=e.state.vnode}e.children&&e.children.forEach(D)}function G(e,t,n,r){var o=t.children||[],i=n.children||[],u=void 0,a=Array.prototype.slice.call(e.childNodes),c=i.length;for(u=0;u<o.length||u<c;u++)U(a[r],o[u],i[u],u>=c?c:u);return e}function J(e,t,n,r){var o=n.props,i={children:n.children,props:o},u=void 0;if(c(n.fn))u=t.state.$ins.render(i);else try{u=n.fn(i)}catch(e){u=t.state.$ins.render(i)}return U(e,t.state.vnode,u,r),n.state={vnode:u,$ins:t.state.$ins,model:i},e}function K(){return J.apply(null,arguments)}function Q(e,t){var n=this,r=t||{node:null,oldNode:null,ins:null},o=r.node,i=r.oldNode,u=r.ins;e="string"==typeof e?document.querySelector(e):e;var a=function(t){return"updateAll"===t&&function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;try{t=u&&u.render()}catch(e){}U(n,i,t),i=t}()};return t||(e.innerHTML=""),function(t){var r=t;if(r.children&&!r.children.length){var c=r,f=c.props,l={children:c.children,props:f};r=r.fn(l)}return"render"in t&&(r=t.render(),u=t,t.$update=t.$update.bind(n,function(){a("updateAll")})),o?function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;return U(arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i,t),{node:o,oldNode:i=t,ins:u}}(r):function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return o=I(t,a),n.appendChild(o),{node:o,oldNode:i=t,ins:u}}(r)}}var W=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function X(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ee=function(e){function t(){return X(this,t),Y(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return Z(t,P),W(t,[{key:"render",value:function(e){var t=e.props,n=e.children,r=w(n),o=O(n,"else");o.index>=0&&r.splice(o.index,1);var i=w(t);return delete i.cond,t.cond?_("div",i,r):_("div",i,o.children)}}]),t}(),te=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function ne(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function re(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function oe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var ie=function(e){function t(){return ne(this,t),re(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return oe(t,P),te(t,[{key:"handlePath",value:function(e,t){var n=e.match(/__(.*?)__/g),r="";return n&&n.forEach(function(n){r=t[n.substring(2,n.length-2)],e=e.replace(n,void 0===r?"":r)}),e}},{key:"handleAttribute",value:function(e,t){var n=this;Object.keys(e).forEach(function(r){e[r]=n.handlePath(e[r],t)})}},{key:"handleChildren",value:function(e,t){var n=this;return e.forEach(function(e){e.nodeValue&&(e.nodeValue=n.handlePath(e.nodeValue,t)),e.attributes&&n.handleAttribute(e.attributes,t),e.children&&n.handleChildren(e.children,t)}),e}},{key:"render",value:function(e){var t=this,n=e.props,r=e.children;if(n.data){var o="",i=[];n.data.forEach(function(e,u){e.index=u,o=g(e,n.key||"item"),i=i.concat(t.handleChildren(w(r),o))});var u=w(n);return delete u.data,delete u.key,_("div",u,i)}return""}}]),t}(),ue=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function ae(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ce(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function fe(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var le=function(e){function t(){return ae(this,t),ce(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return fe(t,P),ue(t,[{key:"render",value:function(e){var t=e.props,n=e.children;if(t&&Object.keys(t).indexOf("cond")>=0){var r=O(n,"else"),o=n;r.index>=0&&(o=w(n)).splice(r.index,1);var i=w(t);return delete i.cond,t.cond?_("div",i,o):_("div",i,r.children)}return _("div",t,n)}}]),t}(),de=_,se=P,pe=ee,he=ie,ve=le,ye=function(e){for(var t=arguments,n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=t[o];return function(){if("render"in r[0])Q(e)(r[0]);else{var t=Q(e)(_(r[0],null));r.map(function(n){n.$update=function(){t=Q(e,t)(_(r[0],null))}})}}()};exports.l=de,exports.component=se,exports.IF=pe,exports.FOR=he,exports.ELSE=ve,exports.app=ye;
